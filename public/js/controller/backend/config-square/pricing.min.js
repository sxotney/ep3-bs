$(document).ready((function(){$("#pricing-table").on("click",".pricing-date-range-new",(function(t){t.preventDefault();var i=$("#pricing-table-template").html();$(this).closest("table").find("tr:last").before("<tr><td>"+i+"</td></tr>"),$(this).closest("table").find("tr:last").siblings("tr:last").hide().fadeIn(),$(".datepicker").datepicker()})),$("#pricing-table").on("click",".pricing-day-range-new",(function(t){t.preventDefault();var i=$("#pricing-table-template").find(".pricing-day-range").closest("table").closest("td").html();$(this).closest("table").find("tr:last").before("<tr><td>"+i+"</td></tr>"),$(this).closest("table").find("tr:last").siblings("tr:last").hide().fadeIn()})),$("#pricing-table").on("click",".pricing-time-range-new",(function(t){t.preventDefault();var i=$("#pricing-table-template").find(".pricing-time-range").closest("tr").closest("td").html();$(this).closest("table").find("tr:last").before("<tr><td>"+i+"</td></tr>"),$(this).closest("table").find("tr:last").siblings("tr:last").hide().fadeIn()})),$("#pricing-table").on("click",".pricing-price-new",(function(t){t.preventDefault();var i=$("#pricing-table-template").find(".pricing-price").closest("tr").html();$(this).closest("table").find("tr:last").before("<tr>"+i+"</tr>"),$(this).closest("table").find("tr:last").siblings("tr:last").hide().fadeIn(),$(".tooltip").tooltip()})),$("#pricing-table").on("click",".pricing-delete",(function(t){t.preventDefault();var i=200;$(this).closest("tbody").children("tr").length>2?$(this).closest("tr").fadeOut(i,(function(){$(this).remove()})):$(this).parents("tbody:eq(2)").children("tr").length>2?$(this).parents("tr:eq(2)").fadeOut(i,(function(){$(this).remove()})):$(this).parents("tbody:eq(4)").children("tr").length>2?$(this).parents("tr:eq(4)").fadeOut(i,(function(){$(this).remove()})):$(this).parents("tr:eq(6)").fadeOut(i,(function(){$(this).remove()}))})),$("#pricing-save").on("click",(function(t){$("#pricing-form-rules input").remove();var i=0;$("#pricing-table .pricing-price").each((function(e,r){var n=$(r),a=n.parents("tbody:eq(1)").find(".pricing-time-range"),l=a.parents("tbody:eq(2)").find(".pricing-day-range"),c=l.parents("tbody:eq(2)").find(".pricing-date-range"),s=c.find("input.datepicker:first").val(),p=c.find("input.datepicker:last").val(),d=l.find("select:first").val(),o=l.find("select:last").val(),g=a.find("input.timepicker:first").val(),f=a.find("input.timepicker:last").val(),b=n.find("input.pricepicker").val(),v=n.find("select.pricing-rate-gross").val(),u=n.find("input.pricing-rate").val(),h=e,m=n.find("select:last").val(),y=n.find("input.timeblockpicker").val();if(!s.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\.(0[1-9]|1[0-2])\.[0-9]{4}$/))return window.alert('Note: The Date "'+s+'" is invalid - Format: 24.12.2014'),void t.preventDefault();if(!p.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\.(0[1-9]|1[0-2])\.[0-9]{4}$/))return window.alert('Note: The Date "'+p+'" is invalid - Format: 24.12.2014'),void t.preventDefault();if(g.match(/^[0-9]{0,1}[0-9]$/)&&(g+=":00"),!g.match(/^[0-9]{0,1}[0-9]:[0-9][0-9]$/))return window.alert('Note: The time "'+g+'" is invalid - Format: 23:15'),void t.preventDefault();if(f.match(/^[0-9]{0,1}[0-9]$/)&&(f+=":00"),!f.match(/^[0-9]{0,1}[0-9]:[0-9][0-9]$/))return window.alert('Note: The time "'+f+'" is invalid - Format: 23:15'),void t.preventDefault();if(b.match(/^[0-9]+$/)&&(b+=",00"),!b.match(/^[0-9]+,[0-9][0-9]$/))return window.alert('Note: The price "'+b+'" is invalid - Format: 19,95'),void t.preventDefault();if(!y.match(/^[1-9][0-9]*$/))return window.alert('Note: The minutes "'+y+'" are invalid'),void t.preventDefault();var k=JSON.stringify([m,h,s,p,d,o,g,f,b,u,v,y]);$("#pricing-form-rules").append('<input type="hidden" name="pricing-rule-'+e+'" value="'+encodeURI(k)+'">'),i++})),$("#pricing-rules-count").val(i)}));var t,i,e,r=window.pricingRules;$.each(r,(function(r,n){var a=n[1],l=n[3],c=n[4],s=n[5],p=n[6],d=n[7],o=n[8],g=n[9],f=n[10],b=n[11],v=n[12];a||(a="null");var u=""+l+c,h=""+s+p,m=""+d+o;if(u!==t){var y=$("#pricing-table-template").html();$("#pricing-table").find("tr:last").before("<tr><td>"+y+"</td></tr>")}else h!==i?(y=$("#pricing-table-template").find(".pricing-day-range").closest("table").closest("td").html(),$("#pricing-table").find(".pricing-day-range:last").parents("tbody:eq(1)").find("tr:last").before("<tr><td>"+y+"</td></tr>")):m!==e?(y=$("#pricing-table-template").find(".pricing-time-range").closest("table").closest("td").html(),$("#pricing-table").find(".pricing-time-range:last").parents("tbody:eq(1)").find("tr:last").before("<tr><td>"+y+"</td></tr>")):(y=$("#pricing-table-template").find(".pricing-price").html(),$("#pricing-table").find(".pricing-price:last").parents("tbody:eq(1)").find("tr:last").before('<tr><td class="pricing-price">'+y+"</td></tr>"));g=g>=100?g.substring(0,g.length-2)+","+g.substring(g.length-2):g>=10?"0,"+g:"0,0"+g,$("#pricing-table .pricing-dateStart:last").val(l),$("#pricing-table .pricing-dateEnd:last").val(c),$("#pricing-table .pricing-dayStart:last").val(s),$("#pricing-table .pricing-dayEnd:last").val(p),$("#pricing-table .pricing-timeStart:last").val(d.substring(0,5)),$("#pricing-table .pricing-timeEnd:last").val(o.substring(0,5)),$("#pricing-table .pricing-price-number:last").val(g),$("#pricing-table .pricing-rate-gross:last").val(b),$("#pricing-table .pricing-rate:last").val(f),$("#pricing-table .pricing-sid:last").val(a),$("#pricing-table .pricing-timeBlock:last").val(Math.round(v/60)),t=u,i=h,e=m})),$(".datepicker").datepicker()}));